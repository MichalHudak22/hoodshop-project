import{r,u as p,j as e}from"./index-C-hwXzSE.js";import{P as j}from"./ProfileNavigation-sibsX1jl.js";function f(){const[x,d]=r.useState(null),[a,h]=r.useState([]),[c,i]=r.useState(""),o=p();return r.useEffect(()=>{const t=localStorage.getItem("token");if(!t){o("/login");return}fetch("http://localhost:3001/user/profile",{method:"GET",headers:{Authorization:`Bearer ${t}`}}).then(l=>l.json()).then(l=>{l.error?i(l.error):(d(l),fetch("http://localhost:3001/api/order-history/history",{method:"GET",headers:{Authorization:`Bearer ${t}`}}).then(s=>s.json()).then(s=>{console.log("Orders data from endpoint:",s),s.length>0&&console.log("First order items:",s[0].items),s.error?i(s.error):h(s)}).catch(()=>i("Chyba pri načítaní objednávok")))}).catch(()=>i("Chyba pri načítaní údajov o používateľovi"))},[o]),e.jsxs("div",{className:"relative text-white flex flex-col items-center bg-fixed bg-cover bg-no-repeat bg-center",style:{backgroundImage:"url('/img/bg-profile-1.jpg')"},children:[e.jsx("div",{className:"absolute inset-0 bg-black opacity-30 z-0"}),e.jsxs("div",{className:"relative z-10 w-full flex flex-col items-center min-h-screen",children:[c&&e.jsx("div",{className:"text-red-500",children:c}),x&&e.jsx("div",{className:"text-green-500"}),e.jsx("div",{className:"py-8 text-center bg-black w-full",children:e.jsxs("h1",{className:"text-2xl lg:text-4xl font-bold text-white",children:["My ORder ",e.jsx("span",{className:"text-blue-200",children:"History"})]})}),e.jsx("div",{className:"w-full lg:max-w-2xl",children:e.jsx(j,{})}),e.jsxs("div",{className:"w-full px-4",children:[a.length===0&&e.jsx("p",{children:"Nemáte žiadne objednávky."}),a.map(t=>{const l=t.items.reduce((n,m)=>n+m.quantity,0),s=Number(t.total_price);return e.jsxs("div",{className:"lg:w-[85%] xl:w-[1024px] m-auto mb-6 p-4 border-2 border-gray-600 rounded-xl bg-black bg-opacity-80",children:[e.jsxs("h2",{className:"text-center text-xl lg:text-2xl text-blue-200 pb-3",children:[e.jsx("strong",{children:"Order No."})," ",t.order_number]}),e.jsxs("div",{className:"flex flex-col items-center md:flex-row justify-around text-md lg:text-lg",children:[e.jsxs("div",{className:"mb-4 text-left w-[235px]",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(t.created_at).toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",t.full_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",t.profile_email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",t.status||"not specified"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment:"})," ",t.payment_method]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Items:"})," ",l]})]}),e.jsxs("div",{className:"mb-4 text-left w-[235px]",children:[e.jsx("strong",{children:"Items:"}),e.jsx("ul",{className:"list-none",children:t.items.map(n=>e.jsxs("li",{className:"text-sm",children:[n.product_name," - ",n.quantity," pcs - ",n.price," €"]},n.id))})]})]}),e.jsxs("p",{className:"mt-1 font-semibold text-center text-lg text-green-600",children:[e.jsx("strong",{className:"text-white",children:"Total Price:"})," ",(s+t.used_points*.1).toFixed(2)," €"]}),t.used_points>0&&e.jsxs("p",{className:"text-center font-semibold text-white text-lg mt-2",children:[e.jsx("strong",{className:"text-white",children:"Used Points:"})," ",t.used_points," -",e.jsxs("span",{className:"text-green-600",children:[" (",(t.used_points*.1).toFixed(2)," €)"]})]}),e.jsxs("p",{className:"mt-2 font-semibold text-center text-xl text-green-400",children:[e.jsx("strong",{className:"text-white",children:"Amount Paid:"})," ",s.toFixed(2)," €"]})]},t.id)})]})]})]})}export{f as default};
